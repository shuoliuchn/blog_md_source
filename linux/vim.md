## vim 的基本使用

[TOC]

### vi 和 vim 简单介绍

Windows 系统内置有 `记事本` 作为文本文件的编辑工具。这个工具可以用，但是显示效果很差，而且功能很少还不支持扩展。所以，很多人都会安装一个 `notepad++` 作为文本编辑工具。notepad++ 显示效果很清晰，支持代码高亮显示等功能。

与 Windows 下的记事本很类似，Linux 系统（事实上，类 Unix 系统皆如此）会自带 vi 文本编辑工具。但因为效果太差，功能太 low，所以大家更喜欢安装 vim 作为文本编辑工具。

vim 就相当于 Windows 系统中的 notepad++。它是一个高级编辑器，支持编程、代码高亮、搜索、文件内容替换等功能。

vi 和 vim 的操作和命令基本一致，所以下面统一以 vim 为例进行介绍。

vim 一般不会系统自带，需要单独安装：

```shell
yum install vim -y
```

### vim 的使用步骤

1. 使用命令打开文本文件：

   ```shell
   vim file.txt
   ```

2. 此时会进入命令模式的状态。输入字母 i，进入编辑模式。这时你就可以通过键盘修改文件中的内容了。

3. 按下 esc 键退出编辑模式，返回命令模式（注意要使用英文输入法）。

4. 输入冒号，进入底线命令模式。输入 `:wq!` 保存文件并退出 vim。

   命令解释：

   - w write，写入修改内容
   - q quit，退出 vim
   - ! 感叹号是强制的意思

### vim 的三个模式

从前面的使用实例中可以看到，vim 有三个模式：命令模式（Command mode），输入模式（Insert mode）和底线命令模式（Last line mode）。

#### 命令模式

用户通过 vim 命令打开文件，最先进入的就是命令模式。

在这个状态下，用户敲击键盘会被 vim 识别为命令，而非输入内容。比如我们输入 i，并不会在文档中出现字符 i，而是被 vim 识别为进入插入编辑的模式的命令。

**复制、删除、粘贴相关命令**

```
yy    拷贝光标所在行
dd    删除光标所在行
D     删除当前光标到行尾的内容
dG    删除当前行到文档尾部的内容（若光标在首行则删除整个文档）
p     粘贴 yy 所复制的内容
x     删除光标所在的字符
u     撤销上一步操作
```

**查找**

```
/word    在整篇文档中搜索word字符串，向下查找，按下n前往下一个单词，N前往上一个
?word    在整篇文档中搜索word字符串，向上查找，按下n前往下一个单词，N前往上一个

*        查找整个文档，跳转到下一个光标所在的单词，n下一个，N上一个
#        查找整个文档，跳转到上一个光标所在的单词，n下一个，N上一个

gd       找到整篇文档中非注释的第一个光标所在单词

%        找到括号的另一半！！
```

**移动光标**

```
w(e)    移动光标到下一个单词
b       移动光标到上一个单词

数字0    移动到本行开头
$       移动光标到本行末尾

H       移动光标到屏幕首行
M       移动光标到屏幕居中行
L       移动光标到屏幕底行
gg      移动光标到文档的尾行
G       移动光标到文档尾行

ctrl + f    下一页
ctrl + b    上一页

`       移动光标到上一次修改行
```

**数字与命令**

```
3yy    向下方拷贝光标所在的3行
5dd    向下删除光标所在的5行
```

#### 输入模式

在命令模式下，输入 i、a 或 o 即可进入输入模式。这三种模式的区别为：

```
i    在当前光标位置开始编辑
a    在光标后开始编辑
o    在光标下一行开始编辑
```

进入输入模式后即可使用键盘编辑文件内容。

编辑好之后，按下 esc 键退出输入模式，进入命令模式。

**底线命令模式**

在命令模式下输入英文冒号 `:` 即可进入底线命令模式。常用的底线命令有：

```
:q!        强制退出
:wq!       强制写入推出（一般情况下，不必加感叹号）

:set nu    显示行号
:set nonu  取消显示行号

:数字       跳到数字那一行

:! command 暂时离开vim窗口，执行command的结果
  # 例如：
:!ip a     临时查看ip信息，然会可以回到vim
```

### 实例：使用 vim 写一个 Python 脚本

具体流程为：

1. 安装 vim：

   ```shell
   yum install  vim -y
   ```

2. 编写一个文件，内容如下：

   Linux 的文件后缀没有意义，只是文件标识而已

   ```shell
   [root@localhost tmp]# cat first.py 
   #!coding:utf8
   print ("爱的魔力转圈圈，想你想到心花黑天白夜")
   ```

3. 执行脚本：

   ```shell
   python  first.py
   ```

### vim 工作模式切换示意图

![QQ图片20200205113053](vim.assets/QQ图片20200205113053.jpg)

### vim 键盘图

![img](vim.assets/vi-vim-cheat-sheet-sch.gif)



更多更详细 vim 命令，参见菜鸟教程 [Linux vi/vim](https://www.runoob.com/linux/linux-vim.html)

