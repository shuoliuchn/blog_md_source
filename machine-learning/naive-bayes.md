

# æœ´ç´ è´å¶æ–¯ç®—æ³•

[TOC]

## æœ´ç´ è´å¶æ–¯æ¦‚è¿°

åœ¨è®¸å¤šåˆ†ç±»ç®—æ³•åº”ç”¨ä¸­ï¼Œç‰¹å¾å’Œæ ‡ç­¾ä¹‹é—´çš„å…³ç³»å¹¶éæ˜¯å†³å®šæ€§çš„ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬æƒ³é¢„æµ‹ä¸€ä¸ªäººç©¶ç«Ÿæ˜¯å¦ä¼šåœ¨æ³°å¦å°¼å…‹å·æµ·éš¾ä¸­ç”Ÿå­˜ä¸‹æ¥ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å»ºç«‹æŸä¸ªåˆ†ç±»æ¨¡å‹æ¥å­¦ä¹ æˆ‘ä»¬çš„è®­ç»ƒé›†ã€‚

åœ¨è®­ç»ƒä¸­ï¼Œå…¶ä¸­ä¸€ä¸ªäººçš„ç‰¹å¾ä¸º 30 å²ï¼Œç”·ï¼Œæ™® é€šèˆ±ï¼Œä»–æœ€ååœ¨æ³°å¦å°¼å…‹å·æµ·éš¾ä¸­å»ä¸–äº†ã€‚å½“æˆ‘ä»¬æµ‹è¯•çš„æ—¶å€™ï¼Œæˆ‘ä»¬å‘ç°æœ‰å¦ä¸€ä¸ªäººçš„ç‰¹å¾ä¹Ÿä¸º 30 å²ï¼Œç”·ï¼Œæ™®é€š èˆ±ã€‚

åŸºäºåœ¨è®­ç»ƒé›†ä¸­çš„å­¦ä¹ ï¼Œæˆ‘ä»¬çš„æ¨¡å‹å¿…ç„¶ä¼šç»™è¿™ä¸ªäººæ‰“ä¸Šæ ‡ç­¾ï¼šå»ä¸–ã€‚ç„¶è€Œè¿™ä¸ªäººçš„çœŸå®æƒ…å†µä¸€å®šæ˜¯å»ä¸–äº†å—?å¹¶éå¦‚æ­¤ã€‚ä¹Ÿè®¸è¿™ä¸ªäººæ˜¯å¿ƒè„ç—…æ‚£è€…ï¼Œå¾—åˆ°äº†ä¸Šæ•‘ç”Ÿè‰‡çš„ä¼˜å…ˆæƒã€‚åˆæœ‰å¯èƒ½ï¼Œè¿™ä¸ªäººå°±æ˜¯æŒ¤ä¸Šäº†æ•‘ç”Ÿè‰‡ï¼Œæ´»äº†ä¸‹æ¥ã€‚

å¯¹åˆ†ç±»ç®—æ³• æ¥è¯´ï¼ŒåŸºäºè®­ç»ƒçš„ç»éªŒï¼Œè¿™ä¸ªäººâ€œå¾ˆæœ‰å¯èƒ½â€æ˜¯æ²¡æœ‰æ´»ä¸‹æ¥ï¼Œä½†ç®—æ³•æ°¸è¿œä¹Ÿæ— æ³•ç¡®å®šâ€è¿™ä¸ªäººä¸€å®šæ²¡æœ‰æ´»ä¸‹æ¥â€œã€‚å³ä¾¿è¿™ ä¸ªäººæœ€åçœŸçš„æ²¡æœ‰æ´»ä¸‹æ¥ï¼Œç®—æ³•ä¹Ÿæ— æ³•ç¡®å®šåŸºäºè®­ç»ƒæ•°æ®ç»™å‡ºçš„åˆ¤æ–­ï¼Œæ˜¯å¦çœŸçš„è§£é‡Šäº†è¿™ä¸ªäººæ²¡æœ‰å­˜æ´»ä¸‹æ¥çš„çœŸå®æƒ…å†µã€‚

è¿™å°±æ˜¯è¯´ï¼Œç®—æ³•å¾—å‡ºçš„ç»“è®ºï¼Œæ°¸è¿œä¸æ˜¯ 100% ç¡®å®šçš„ï¼Œæ›´å¤šçš„æ˜¯åˆ¤æ–­å‡ºäº†ä¸€ç§â€œæ ·æœ¬çš„æ ‡ç­¾æ›´å¯èƒ½æ˜¯æŸç±»çš„å¯èƒ½æ€§â€ï¼Œè€Œéä¸€ç§â€œç¡®å®šâ€ã€‚

æˆ‘ä»¬é€šè¿‡æ¨¡å‹ç®—æ³•çš„æŸäº›è§„å®šï¼Œæ¥å¼ºè¡Œè®©ç®—æ³•ä¸ºæˆ‘ä»¬è¿”å›ä¸€ä¸ªå›ºå®šçš„åˆ†ç±»ç»“æœã€‚ä½†è®¸å¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿå¸Œæœ›èƒ½å¤Ÿç†è§£ç®—æ³•åˆ¤æ–­å‡ºç»“æœçš„å¯èƒ½æ€§æ¦‚ç‡ã€‚

æ— è®ºå¦‚ä½•ï¼Œæˆ‘ä»¬éƒ½å¸Œæœ›ä½¿ç”¨çœŸæ­£çš„æ¦‚ç‡æ¥è¡¡é‡å¯èƒ½æ€§ï¼Œå› æ­¤å°±æœ‰äº†çœŸæ­£çš„æ¦‚ç‡ç®—æ³•ï¼šæœ´ç´ è´å¶æ–¯ã€‚

æœ´ç´ è´å¶æ–¯æ˜¯ä¸€ç§ç›´æ¥è¡¡é‡æ ‡ç­¾å’Œç‰¹å¾ä¹‹é—´çš„æ¦‚ç‡å…³ç³»çš„æœ‰ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œæ˜¯ä¸€ç§ä¸“æ³¨åˆ†ç±»çš„ç®—æ³•ã€‚æœ´ç´ è´å¶æ–¯çš„ç®—æ³•æ ¹æºå°±æ˜¯åŸºäºæ¦‚ç‡è®ºå’Œæ•°ç†ç»Ÿè®¡çš„è´å¶æ–¯ç†è®ºï¼Œå› æ­¤å®ƒæ˜¯æ ¹æ­£è‹—çº¢çš„æ¦‚ç‡æ¨¡å‹ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥è®¤è¯†ä¸€ä¸‹è¿™ä¸ªç®€å•å¿«é€Ÿçš„æ¦‚ç‡ç®—æ³•ã€‚

ç°åœ¨æˆ‘ä»¬å¯¹é‚®ç®±çš„é‚®ä»¶å’Œæ–‡ç« è¿›è¡Œåˆ†ç±»ï¼š

![lajiyouxiangfenlei](naive-bayes.assets/lajiyouxiangfenlei.png)

![image.png](naive-bayes.assets/Mon,%2020%20Apr%202020%20010047.png)

ä¸Šå›¾æ‰€ç¤ºï¼Œæ˜¯ä¸æ˜¯è¯´ï¼Œé‚£ä¸ªç±»åˆ«å¯èƒ½æ€§å çš„æ¯”ä¾‹è¾ƒå¤§ï¼Œåˆ™å°†é‚®ä»¶æˆ–è€…æ–‡ç« å½’ä¸ºå“ªä¸€ç±»å‘¢ï¼Ÿè¿™é‡Œçš„å æ¯”æŒ‡çš„å°±æ˜¯åˆ†ç±»çš„æ¦‚ç‡ã€‚

## æ¦‚ç‡åŸºç¡€

æ‰€è°“æ¦‚ç‡ï¼Œä¹Ÿå°±æ˜¯ä¸€ä»¶äº‹æƒ…å‘ç”Ÿçš„å¯èƒ½æ€§ã€‚æ¯”å¦‚ï¼Œæ‰”ä¸€ä¸ªç¡¬å¸ï¼Œæ­£é¢æœä¸Šçš„å¯èƒ½æ€§ï¼Œæˆ–è€…æŸå¤©æ˜¯é˜´å¤©çš„å¯èƒ½æ€§ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä»¥ä¸€ä¸ªä¾‹å­ï¼Œç®€å•ç ”ç©¶ä¸€ä¸‹æ¦‚ç‡çš„å«ä¹‰å’Œè®¡ç®—æ–¹å¼ã€‚

æˆ‘ä»¬æœ‰å¦‚ä¸‹æ ·æœ¬ï¼Œæ ¹æ®èŒä¸šå¯æé†’çš„ä¸åŒï¼Œè¢«å–œæ¬¢çš„ç¨‹åº¦ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œåªæ˜¯ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œåªæœ‰ä¸ƒä¸ªæ ·æœ¬æ–¹ä¾¿è®¡ç®—ã€‚åœ¨ç°å®ä¸­ï¼Œè¿™ä¹ˆå°‘çš„æ ·æœ¬å‡ºç°çš„é¢‘ç‡æ˜¯ä¸å¯ä»¥è®¤ä½œä¸ºæ¦‚ç‡çš„ã€‚è¿™é‡Œéœ€è¦å‡è®¾ä¸€ä¸ªå‰æï¼Œå°±æ˜¯æ ·æœ¬ä¸­å‡ºç°çš„é¢‘ç‡å°±ç­‰åŒäºè¯¥äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ã€‚åŒæ—¶ï¼Œè¿˜è¦å‡è®¾ä½“å‹å’ŒèŒä¸šè¿™ä¸¤ä¸ªäº‹ä»¶ç›¸äº’ç‹¬ç«‹ã€‚

| æ ·æœ¬ç¼–å· |  èŒä¸š  | ä½“å‹ | å¥³ç¥æ˜¯å¦å–œæ¬¢ |
| :------: | :----: | :--: | :----------: |
|    1     | ç¨‹åºå‘˜ | è¶…é‡ |    ä¸å–œæ¬¢    |
|    2     |  äº§å“  | åŒ€ç§° |     å–œæ¬¢     |
|          | ç¨‹åºå‘˜ | åŒ€ç§° |     å–œæ¬¢     |
|          | ç¨‹åºå‘˜ | è¶…é‡ |     å–œæ¬¢     |
|          |  ç¾å·¥  | åŒ€ç§° |    ä¸å–œæ¬¢    |
|          |  ç¾å·¥  | è¶…é‡ |    ä¸å–œæ¬¢    |
|          |  äº§å“  | åŒ€ç§° |     å–œæ¬¢     |

è®¡ç®—å¦‚ä¸‹å‡ ä¸ªæ¦‚ç‡ï¼š

1. å¥³ç¥å–œæ¬¢ä¸€ä¸ªäººçš„æ¦‚ç‡ã€‚

   æ€»å…±æœ‰ 7 ä¸ªäººï¼Œå¥³ç¥å–œæ¬¢ 4 ä¸ªï¼Œæ‰€ä»¥å¥³ç¥å–œæ¬¢ä¸€ä¸ªäººçš„æ¦‚ç‡æ˜¯ 4/7

2. èŒä¸šæ˜¯ç¨‹åºå‘˜å¹¶ä¸”ä½“å‹åŒ€ç§°çš„æ¦‚ç‡ã€‚

   èŒä¸šæ˜¯ç¨‹åºå‘˜çš„æ¦‚ç‡ä¸º 3/7ï¼›ä½“å‹åŒ€ç§°çš„æ¦‚ç‡ä¸º 4/7ã€‚é‚£ä¹ˆèŒä¸šæ˜¯ç¨‹åºå‘˜ä¸”ä½“å‹åŒ€ç§°çš„æ¦‚ç‡ä¸º `3/7 * 4/7 = 12/49`ã€‚

   è¿™é‡Œåº”ç”¨åˆ°ä¸€ä¸ªç‹¬ç«‹äº‹ä»¶åŒæ—¶å‘ç”Ÿçš„è®¡ç®—å…¬å¼ï¼Œæˆ‘ä»¬ç¨åä¼šæåˆ°ï¼Œ`P(ç¨‹åºå‘˜, åŒ€ç§°) = P(ç¨‹åºå‘˜) * P(åŒ€ç§°)`ã€‚

3. åœ¨å¥³ç¥å–œæ¬¢çš„æ¡ä»¶ä¸‹ï¼ŒèŒä¸šæ˜¯ç¨‹åºå‘˜çš„æ¦‚ç‡ã€‚

   å¥³ç¥å–œæ¬¢çš„æƒ…å†µæœ‰ 4 ç§ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªæƒ…å†µæ˜¯ç¨‹åºå‘˜ï¼Œæ¦‚ç‡ä¸º `2/4 = 1/2`ã€‚

   è¿™é‡Œæ¶‰åŠåˆ°æ¡ä»¶æ¦‚ç‡ï¼Œå¯ä»¥è¿™æ ·è¡¨ç¤ºï¼š`P(ç¨‹åºå‘˜|å¥³ç¥å–œæ¬¢) = 1/2`

4. åœ¨å¥³ç¥å–œæ¬¢çš„æ¡ä»¶ä¸‹ï¼ŒèŒä¸šæ˜¯äº§å“ï¼Œä½“é‡è¶…é‡çš„æ¦‚ç‡ã€‚

   è¿™ä¸ªæ˜¯ç»¼åˆä½¿ç”¨æ¡ä»¶æ¦‚ç‡å’Œä¹˜æ³•å…¬å¼çš„æ¡ˆä¾‹ï¼Œå…¶è®¡ç®—æ–¹æ³•ä¸ºï¼š`P(äº§å“, è¶…é‡|å¥³ç¥å–œæ¬¢) = P(äº§å“|å¥³ç¥å–œæ¬¢) * P(è¶…é‡|å¥³ç¥å–œæ¬¢)`ã€‚

   äºæ˜¯è¿™é“é¢˜çš„æ¦‚ç‡ä¸ºï¼š`1/2 * 1/4 = 1/8`

é€šè¿‡ä»¥ä¸Šä¾‹å­æˆ‘ä»¬äº†è§£åˆ°ä¸¤ä¸ªæ¦‚ç‡è®¡ç®—å‡†åˆ™ï¼šè”åˆæ¦‚ç‡å’Œæ¡ä»¶æ¦‚ç‡ã€‚

è”åˆæ¦‚ç‡æŒ‡çš„æ˜¯å¤šä¸ªæ¡ä»¶åŒæ—¶æˆç«‹çš„æ¦‚ç‡ï¼Œè®°ä½œï¼š`P(A, B)`ã€‚

ç‹¬ç«‹äº‹ä»¶çš„è”åˆæ¦‚ç‡çš„è®¡ç®—å…¬å¼ä¸ºï¼š`P(A, B) = P(A) * P(B)`

æ¡ä»¶æ¦‚ç‡æŒ‡çš„æ˜¯åœ¨äº‹ä»¶ A å‘ç”Ÿçš„æ¡ä»¶ä¸‹ï¼Œäº‹ä»¶ B å‘ç”Ÿçš„æ¦‚ç‡ï¼Œè®°ä½œï¼š`P(B|A)`ã€‚

æ¡ä»¶æ¦‚ç‡çš„è®¡ç®—å…¬å¼ä¸ºï¼š`P(B|A) = P(AB)/P(B)`

æ³¨æ„ï¼š

- ä¸Šè¿°çš„æ±‚æ¦‚ç‡å…¬å¼åªé€‚ç”¨äºå„ä¸ªç‰¹å¾ä¹‹é—´æ˜¯æ¡ä»¶ç‹¬ç«‹ï¼ˆæ¯ä¸ªç‰¹å¾ä¹‹é—´æ²¡æœ‰å¿…ç„¶å…³ç³»ï¼‰çš„ã€‚æ¡ä»¶ä¸ç‹¬ç«‹æŒ‡çš„æ˜¯ç‰¹å¾ä¹‹é—´æœ‰å…³è”çš„ã€‚æ¯”å¦‚ï¼Œä½“é‡å’Œæ˜¯å¦å–œæ¬¢åƒé›¶é£Ÿè¿™ä¸¤ä¸ªæ¡ä»¶ä¹‹é—´å°±æœ‰å…³è”ã€‚
- æœ´ç´ è´å¶æ–¯åªé€‚ç”¨äºç‰¹å¾ä¹‹é—´æ˜¯æ¡ä»¶ç‹¬ç«‹çš„æƒ…å†µä¸‹ã€‚å¦åˆ™åˆ†ç±»æ•ˆæœä¸å¥½ã€‚è¿™é‡Œçš„æœ´ç´ æŒ‡çš„å°±æ˜¯æ¡ä»¶ç‹¬ç«‹ã€‚
- æœ´ç´ è´å¶æ–¯ä¸»è¦è¢«å¹¿æ³›åœ°åº”ç”¨äºæ–‡ç« åˆ†ç±»ä¸­ã€‚

## æœ´ç´ è´å¶æ–¯çš„åˆ†ç±»

åœ¨ sklearn ä¸­æä¾›äº†ä¸‰ç§ä¸åŒç±»å‹çš„è´å¶æ–¯æ¨¡å‹ç®—æ³•ï¼š

- é«˜æ–¯æ¨¡å‹
- å¤šé¡¹å¼æ¨¡å‹
- ä¼¯åŠªåˆ©æ¨¡å‹

### é«˜æ–¯åˆ†å¸ƒï¼ˆæ­£æ€åˆ†å¸ƒï¼‰

é«˜æ–¯åˆ†å¸ƒï¼Œä¹Ÿå°±æ˜¯æ­£æ€åˆ†å¸ƒï¼Œæ˜¯ä¸€ç§è¿ç»­å‹å˜é‡çš„æ¦‚ç‡åˆ†å¸ƒã€‚ç®€å•æ¥è¯´ï¼Œé«˜æ–¯åˆ†å¸ƒå°±æ˜¯å½“é¢‘ç‡ç›´æ–¹å›¾çš„åŒºé—´å˜å¾—ç‰¹åˆ«å°æ—¶çš„æ‹Ÿåˆæ›²çº¿ï¼Œåƒåº§å°å±±å³°ï¼Œå…¶ä¸­ä¸¤ç«¯çš„ç‰¹åˆ«å°ï¼Œè¶Šå¾€ä¸­é—´è¶Šé«˜ã€‚

æ‰€è°“æ­£æ€åˆ†å¸ƒï¼Œå°±æ˜¯æ­£å¸¸å½¢æ€çš„åˆ†å¸ƒï¼Œå®ƒæ˜¯è‡ªç„¶ç•Œçš„ä¸€ç§è§„å¾‹ã€‚

ç°å®ç”Ÿæ´»ä¸­æœ‰å¾ˆå¤šç°è±¡å‡æœä»é«˜æ–¯åˆ†å¸ƒï¼Œæ¯”å¦‚æ”¶å…¥ï¼Œèº«é«˜ï¼Œä½“é‡ç­‰ï¼Œå¤§éƒ¨åˆ†éƒ½å¤„äºä¸­ç­‰æ°´å¹³ï¼Œç‰¹åˆ«å°‘å’Œç‰¹åˆ«å¤šçš„æ¯”ä¾‹éƒ½ä¼šæ¯”è¾ƒä½ã€‚

ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­ï¼Œæ›´å¥½åœ°äº†è§£é«˜æ–¯åˆ†å¸ƒã€‚

ä¸€èµ·ç©ä¸€ä¸ªæ¸¸æˆæŠ›ç¡¬å¸ï¼Œæ¸¸æˆè§„åˆ™ä¸ºï¼š

å®šä¹‰æ¯ä¸ªæŠ›å‡ºç¡¬å¸æ­£é¢è®° +1 åˆ†ï¼Œåé¢è®° -1 åˆ†

æ­¤æ—¶æˆ‘ä»¬å¯ä»¥å¾—çŸ¥æŠ›ä¸€æ¬¡ç¡¬å¸ä¸ºæ­£é¢çš„æ¦‚ç‡å’Œä¸ºåé¢çš„æ¦‚ç‡å„ä¸º 50%ï¼Œé‚£ä¹Ÿå°±æ˜¯ä¼šæœ‰ä¸€åŠæ¦‚ç‡ +1 åˆ†ï¼Œä¸€åŠæ¦‚ç‡ -1 åˆ†ã€‚

å¦‚æœæˆ‘ä»¬è¿ç»­æŠ›10æ¬¡ç¡¬å¸ï¼Œåˆ™å¾—åˆ°çš„è®°åˆ†ç»Ÿè®¡ä¸ºï¼š

![image.png](naive-bayes.assets/Tue,%2021%20Apr%202020%20000921.png)



ç”»ä¸ªå›¾æ„Ÿå—ä¸€ä¸‹ï¼š

![image.png](naive-bayes.assets/Tue,%2021%20Apr%202020%20000918.png)

å¦‚æœæŠ› 100 æ¬¡ï¼Œç”šè‡³æ˜¯æ— ç©·å¤šæ¬¡å‘¢ï¼Ÿå¹³å‡åˆ†æ•°åˆ†å¸ƒæƒ…å†µå¤§æ¦‚æ˜¯ä»€ä¹ˆæ ·å‘¢ï¼Ÿç”»ä¸ªå›¾æ„Ÿå—ä¸€ä¸‹ï¼š

![image.png](naive-bayes.assets/Tue,%2021%20Apr%202020%20000914.png)

æ›²çº¿å‘ˆç°ä¸ºæ­£å¤ªåˆ†å¸ƒ

ä¸ºä»€ä¹ˆåœ¨æˆ‘ä»¬çš„ç°å®ç”Ÿæ´»ä¸­æ­£å¤ªåˆ†å¸ƒå¦‚æ­¤å¸¸è§å‘¢ï¼Ÿ

é€šå¸¸æƒ…å†µä¸‹ä¸€ä¸ªäº‹ç‰©çš„å½±å“å› ç´ å¾€å¾€æœ‰å¤šä¸ªï¼Œæ¯”å¦‚èº«é«˜çš„å½±å“æœ‰ï¼š

- å®¶åº­çš„é¥®é£Ÿä¹ æƒ¯
- å®¶åº­é•¿è¾ˆçš„èº«é«˜
- è¿åŠ¨æƒ…å†µ
- ......

å…¶ä¸­çš„æ¯ä¸€ä¸ªå› ç´ ï¼Œéƒ½ä¼šå¯¹èº«é«˜äº§ç”Ÿä¸€å®šçš„å½±å“ï¼Œè¦ä¹ˆæ˜¯æ­£å‘çš„å½±åƒï¼Œè¦ä¹ˆæ˜¯åå‘çš„å½±å“ã€‚æ‰€æœ‰å› ç´ æœ€ç»ˆè®©æ•´ä½“èº«é«˜æ¥è¿‘äºæ­£æ€åˆ†å¸ƒã€‚

é€šè¿‡å‡è®¾ `P(xi|Y)` æ˜¯æœä»é«˜æ–¯åˆ†å¸ƒï¼ˆä¹Ÿå°±æ˜¯æ­£æ€åˆ†å¸ƒï¼‰ï¼Œæ¥ä¼°è®¡æ¯ä¸ªç‰¹å¾ä¸‹åˆ†åˆ°æ¯ä¸ªç±»åˆ« Y ä¸Šçš„æ¡ä»¶æ¦‚ç‡ã€‚å¯¹äºæ¯ä¸ªç‰¹å¾ä¸‹çš„å–å€¼ï¼Œé«˜æ–¯æœ´ç´ è´å¶æ–¯æœ‰å¦‚ä¸‹å…¬å¼:

- exp å‡½æ•°ä¸ºé«˜ç­‰æ•°å­¦é‡Œä»¥è‡ªç„¶å¸¸æ•° e ä¸ºåº•çš„æŒ‡æ•°å‡½æ•°

  ![image.png](naive-bayes.assets/Tue,%2021%20Apr%202020%20001301.png)

é«˜æ–¯åˆ†å¸ƒæ¨¡å‹çš„ä½œç”¨ï¼š

- åœ¨è´å¶æ–¯åˆ†ç±»ä¸­ï¼Œé«˜æ–¯æ¨¡å‹å°±æ˜¯ç”¨æ¥å¤„ç†è¿ç»­å‹ç‰¹å¾å˜é‡çš„ï¼Œå½“ä½¿ç”¨æ­¤æ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬ä¼šå‡å®šç‰¹å¾å±äºé«˜æ–¯åˆ†å¸ƒï¼Œç„¶ååŸºäºè®­ç»ƒæ ·æœ¬è®¡ç®—ç‰¹å¾æ‰€å±æ ‡ç­¾çš„å‡å€¼ï¼ˆğœ‡ï¼‰å’Œæ ‡å‡†å·®ï¼ˆğ›”ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥ä¼°è®¡æŸä¸ªç‰¹å¾å±äºæŸä¸ªç±»åˆ«çš„æ¦‚ç‡ã€‚

  æ¯”å¦‚ï¼šåˆ¤æ–­ä¸€ä¸ªäººå¸…è¿˜æ˜¯ä¸‘ï¼Œåˆ™å¸…&ä¸‘å°±æ˜¯åˆ†ç±»çš„æ ‡ç­¾ï¼Œä¸€ä¸ªäººçš„ç‰¹å¾å‡è®¾æœ‰èº«é«˜ã€ä½“é‡ï¼Œä¸‰å›´ï¼Œåˆ™é«˜æ–¯æ¨¡å‹ä¼šè®¡ç®—å¸¦æœ‰èº«é«˜çš„ç‰¹å¾åˆ†åˆ°å¸…çš„æ¡ä»¶æ¦‚ç‡å’Œä¸‘çš„æ¡ä»¶æ¦‚ç‡ï¼Œåœ¨è®¡ç®—å¸¦æœ‰ä½“é‡çš„ç‰¹å¾åˆ†åˆ°å¸…å’Œä¸‘çš„æ¡ä»¶æ¦‚ç‡ï¼Œä»¥æ­¤ç±»æ¨ã€‚

- å¯¹äºä»»æ„ä¸€ä¸ª Y çš„å–å€¼ï¼Œè´å¶æ–¯éƒ½ä»¥æ±‚è§£æœ€å¤§åŒ–çš„Pä¸ºç›®æ ‡ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½å¤Ÿæ¯”è¾ƒåœ¨ä¸åŒæ ‡ç­¾ä¸‹æˆ‘ä»¬çš„æ ·æœ¬ç©¶ ç«Ÿæ›´é è¿‘å“ªä¸€ä¸ªå–å€¼ã€‚ä»¥æœ€å¤§åŒ– P ä¸ºç›®æ ‡ï¼Œé«˜æ–¯æœ´ç´ è´å¶æ–¯ä¼šä¸ºæˆ‘ä»¬æ±‚è§£å…¬å¼ä¸­çš„å‚æ•° `ğœ‡y` å’Œ `ğ›”y`ã€‚æ±‚è§£å‡ºå‚æ•°åï¼Œå¸¦å…¥ä¸€ä¸ª `xi` çš„å€¼ï¼Œå°±èƒ½å¤Ÿå¾—åˆ°ä¸€ä¸ª P çš„æ¦‚ç‡å–å€¼ã€‚

é«˜æ–¯æ¨¡å‹ API

- `from sklearn.naive_bayes import GaussianNB`

å®ä¾‹åŒ–æ¨¡å‹å¯¹è±¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸éœ€è¦å¯¹é«˜æ–¯æœ´ç´ è´å¶æ–¯ç±»è¾“å…¥ä»»ä½•çš„å‚æ•°ï¼Œå¯ä»¥è¯´æ˜¯ä¸€ä¸ªéå¸¸è½»é‡çº§çš„ç±»ï¼Œæ“ä½œéå¸¸å®¹æ˜“ã€‚ä½†è¿‡äºç®€å•ä¹Ÿæ„å‘³ç€è´å¶æ–¯æ²¡æœ‰å¤ªå¤šçš„å‚æ•°å¯ä»¥è°ƒæ•´ï¼Œå› æ­¤è´å¶æ–¯ç®—æ³•çš„æˆé•¿ç©ºé—´å¹¶ä¸æ˜¯å¤ªå¤§ï¼Œå¦‚æœè´å¶æ–¯ç®—æ³•çš„æ•ˆæœä¸æ˜¯å¤ªç†æƒ³ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šè€ƒè™‘æ¢æ¨¡å‹ã€‚

```python
from sklearn.datasets import load_digits
from sklearn.model_selection import train_test_split
from sklearn.naive_bayes import GaussianNB
# è·å–æ•°æ®
digits = load_digits()
feature = digits.data
target = digits.target
# æ‹†åˆ†æµ‹è¯•é›†å’Œè®­ç»ƒé›†
x_train, x_test, y_train, y_test = train_test_split(feature, target, random_state=420, test_size=0.2)
# å®ä¾‹åŒ–æ¨¡å‹å¯¹è±¡ï¼Œä½¿ç”¨è®­ç»ƒé›†è®­ç»ƒæ¨¡å‹
gnb = GaussianNB()
gnb.fit(x_train, y_train)
# æŸ¥çœ‹æµ‹è¯•é›†çš„åˆ†æ•°
gnb.score(x_test, y_test)    # 0.8472222222222222
```

é¢„æµ‹å‡†ç¡®ç‡è¿˜æ˜¯å¯ä»¥çš„ã€‚

ä»ä¸Šé¢çš„æ“ä½œæˆ‘ä»¬çœ‹åˆ°ï¼Œé«˜æ–¯åˆ†å¸ƒçš„åŸç†è™½ç„¶å¤æ‚ï¼Œä½†æ˜¯å·²ç»å°†ç®—æ³•å°è£…å¥½ï¼Œæˆ‘ä»¬åªéœ€è¦ç®€å•è°ƒç”¨å³å¯ã€‚ç°é˜¶æ®µå•çº¯ä½¿ç”¨ä¸å¿…æ·±ç©¶åŸç†ï¼Œæ—¥åéœ€è¦æ›´è¿›ä¸€æ­¥å®ç°é«˜ç«¯æ“ä½œï¼Œå¯ä»¥ç ”ç©¶ç®—æ³•æ¨¡å‹ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ predict æ–¹æ³•æ¥é¢„æµ‹æŒ‡å®šç‰¹å¾çš„åˆ†ç±»ã€‚predict è¿”å›æ˜¯åˆ†ç±»ç»“æœï¼Œå°±æ˜¯åˆ†ç±»æ¦‚ç‡æœ€å¤§çš„é‚£ä¸€ä¸ªç±»åˆ«ã€‚æ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨æµ‹è¯•é›†çš„ç¬¬ä¸€ä¸ªæ ·æœ¬è¿›è¡Œæµ‹è¯•ï¼ˆè¦æ³¨æ„ predict éœ€è¦çš„å‚æ•°æ˜¯äºŒç»´æ•°æ®ï¼Œx_test ç›´æ¥å–ç´¢å¼•è·å¾—çš„æ˜¯ä¸€ç»´æ•°æ®ï¼Œéœ€è¦å°†å…¶è½¬æˆäºŒç»´æ•°æ®æ‰èƒ½ä½œä¸ºå‚æ•°ä¼ é€’ç»™ predictï¼‰ï¼š

```python
gnb.predict(x_test[0].reshape(1, -1))
```

é¢„æµ‹çš„ç»“æœä¸ºï¼š`array([6])`

æˆ‘ä»¬çœ‹ä¸€ä¸‹æµ‹è¯•é›†ç›®æ ‡æ•°æ®çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼š

```python
y_test[0]
```

æœç„¶æ˜¯ 6ï¼Œé¢„æµ‹æˆåŠŸã€‚

é™¤äº†é¢„æµ‹åˆ†ç±»ç»“æœï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ predict_proba æ–¹æ³•æŸ¥çœ‹æ¯ä¸€ä¸ªæµ‹è¯•é›†æ ·æœ¬å±äºæ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œæœ€å¤§çš„å°±æ˜¯åˆ†ç±»ç»“æœï¼š

```python
gnb.predict_proba(x_test[0].reshape(1, -1))    # å‚æ•°éœ€è¦æ˜¯äºŒç»´æ•°æ®
```

é¢„æµ‹åˆ°çš„æ¯ä¸ªåˆ†ç±»çš„å¯èƒ½æ€§ä¸ºï¼š

```python
array([[0.00000000e+000, 9.69688733e-054, 1.08613431e-106,
        3.57594751e-096, 0.00000000e+000, 4.60851822e-046,
        1.00000000e+000, 0.00000000e+000, 4.83837016e-036,
        1.55718269e-123]])
```

é™¤äº†ç¬¬ä¸ƒä¸ªä¹‹å¤–ï¼Œæ‰€æœ‰çš„æ¦‚ç‡éƒ½éå¸¸å°ï¼ˆä¸è¦çœ‹æ•°å€¼å¤§å°ï¼Œè¦çœ‹ e åé¢çš„é‡çº§å¤§å°ï¼‰ã€‚è€Œç¬¬ä¸ƒä¸ªç±»åˆ«çš„æ¦‚ç‡æ˜¯ 1ã€‚å› ä¸ºæ•°æ®æ˜¯ä» 0 å¼€å§‹æ’åˆ—ï¼Œç¬¬ä¸ƒä¸ªåˆšå¥½å°±æ˜¯ 6ï¼Œä¹Ÿå°±æ˜¯é¢„æµ‹çš„ç»“æœäº†ã€‚

ä¸Šé¢çš„é¢„æµ‹ç»“æœä¸­ï¼Œæ•°æ®é‡çº§å·®å¼‚ç‰¹åˆ«å·¨å¤§ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒä»¬çš„å¯¹æ•°æ¥æ¯”è¾ƒå¤§å°ã€‚å¯¹æ•°å‡½æ•°æ˜¯ä¸€ä¸ªå¢å‡½æ•°ï¼Œæ‰€ä»¥å¯¹æ•°å€¼è¶Šå¤§çš„æ•°ï¼ŒåŸæ¥çš„æ•°å€¼ä¹Ÿè¶Šå¤§ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€æ‰¾åˆ°å¯¹æ•°æœ€å¤§çš„ï¼Œå³å¯æ‰¾åˆ°æ¦‚ç‡æœ€å¤§çš„ã€‚

predict_log_proba æ–¹æ³•å°±æ˜¯ predict_proba çš„å¯¹æ•°è½¬åŒ–ï¼Œæœ€å¤§çš„å°±æ˜¯åˆ†ç±»ç»“æœï¼š

```python
gnb.predict_log_proba(x_test[0].reshape(1, -1))
```

å¾—åˆ°äº†æ¯ä¸ªåˆ†ç±»å¯èƒ½æ€§çš„å¯¹æ•°å€¼ï¼š

```python
array([[-1.75243114e+03, -1.22067790e+02, -2.43991395e+02,
        -2.19773939e+02, -1.85849980e+08, -1.04391008e+02,
         0.00000000e+00, -1.85847933e+09, -8.13164854e+01,
        -2.82775088e+02]])
```

å¯¹æ•°æœ€å¤§çš„æ˜¾ç„¶è¿˜æ˜¯ç¬¬ä¸ƒä¸ªï¼Œé¢„æµ‹ç»“æœæ²¡æœ‰å˜ã€‚

ç»éªŒï¼šè´å¶æ–¯æœ¬èº«æ›´åŠ æ“…é•¿çº¿æ€§å¯åˆ†çš„äºŒåˆ†æ•°æ®ï¼Œä½†æœ´ç´ è´å¶æ–¯åœ¨ç¯å½¢æ•°æ®å’Œæœˆäº®å‹æ•°æ®ä¸Šä¹Ÿå¯ä»¥æœ‰è¿œè¿œèƒœè¿‡å…¶ä»–çº¿ æ€§æ¨¡å‹çš„è¡¨ç°ã€‚

![image.png](naive-bayes.assets/Tue,%2021%20Apr%202020%20005157.png)

![image.png](naive-bayes.assets/Tue,%2021%20Apr%202020%20005154.png)

### å¤šé¡¹å¼æ¨¡å‹

ä¸é«˜æ–¯åˆ†å¸ƒç›¸åï¼Œå¤šé¡¹å¼æ¨¡å‹ä¸»è¦é€‚ç”¨äºç¦»æ•£ç‰¹å¾çš„æ¦‚ç‡è®¡ç®—ï¼Œä¸” sklearn çš„å¤šé¡¹å¼æ¨¡å‹ä¸æ¥å—è¾“å…¥è´Ÿå€¼ã€‚è™½ç„¶ sk-learn ä¸­çš„å¤šé¡¹å¼æ¨¡å‹ä¹Ÿå¯ä»¥è¢«ç”¨ä½œåœ¨è¿ç»­æ€§ç‰¹å¾æ¦‚ç‡è®¡ç®—ä¸­ï¼Œä½†æ˜¯æˆ‘ä»¬å¦‚æœæƒ³è¦å¤„ç†è¿ç»­æ€§å˜é‡åˆ™æœ€å¥½é€‰æ‹©ä½¿ç”¨é«˜æ–¯æ¨¡å‹ã€‚

æ³¨æ„ï¼šå› ä¸ºå¤šé¡¹å¼ä¸æ¥å—è´Ÿå€¼çš„è¾“å…¥ï¼Œæ‰€ä»¥å¦‚æœæ ·æœ¬æ•°æ®çš„ç‰¹å¾ä¸ºæ•°å€¼å‹æ•°æ®çš„è¯ï¼ŒåŠ¡å¿…è¦è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ä¿è¯ç‰¹å¾æ•°æ®ä¸­æ— è´Ÿå€¼å‡ºç°ã€‚

åŸç†ï¼šè®¡ç®—å‡ºä¸€ç¯‡æ–‡ç« ä¸ºæŸäº›ç±»åˆ«çš„æ¦‚ç‡ï¼ˆæ–‡ç« æ˜¯å›ºå®šçš„ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è¯¥è¿ç« ä¸ºå‰æä¸‹æ±‚å‡ºæ‰€å±ç±»åˆ«çš„æ¦‚ç‡ï¼Œå› æ­¤æ–‡ç« å°±æ˜¯æ¦‚ç‡è®ºä¸­æ¡ä»¶æ¦‚ç‡çš„æ¡ä»¶ï¼‰ï¼Œæœ€å¤§æ¦‚ç‡çš„ç±»å‹å°±æ˜¯è¯¥æ–‡ç« çš„ç±»åˆ«ã€‚

`P(ç±»åˆ«|æ–‡ç« )`ï¼šç±»åˆ«å¯ä»¥ä¸ºå†›äº‹ï¼Œè´¢ç»ï¼Œä½“è‚²ç­‰ç­‰ï¼Œæ–‡ç« å…¶å®å°±æ˜¯ä¸€ä¸ªåˆä¸€ä¸ªçš„è¯è¯­ã€‚æ¯”å¦‚æœ‰ä¸€ç¯‡æ–‡ç« 

- `P(ä½“è‚²|è¯1ï¼Œè¯2ï¼Œè¯3......)==1/6`
- `P(è´¢ç»|è¯1ï¼Œè¯2ï¼Œè¯3......)==1/3`

åˆ™è¯¥æ–‡ç« å±äºè´¢ç»ç±»åˆ«ï¼Œé‚£ä¹ˆ `P(è´¢ç»|è¯1ï¼Œè¯2ï¼Œè¯3......)` å¦‚ä½•è®¡ç®—å€¼å‘¢ï¼Ÿå¦‚ä½•è®¡ç®—å¤šä¸ªæ¡ä»¶ä¸‹ä¸€ä¸ªç»“æœçš„æ¦‚ç‡å‘¢ï¼Ÿ

æœ´ç´ è´å¶æ–¯ç®—æ³•å…¬å¼ï¼š

![image.png](naive-bayes.assets/Tue,%2021%20Apr%202020%20155224.png)

![image.png](naive-bayes.assets/Tue,%2021%20Apr%202020%20155229.png)

ç»†èŠ‚è§£é‡Šï¼š
- w ä¸ºç»™å®šæ–‡æ¡£çš„ç‰¹å¾ï¼Œä¹Ÿå°±æ˜¯æ–‡ç« ä¸­æ‹†åˆ†å‡ºæ¥çš„ä¸åŒè¯è¯­
- c ä¸ºæ–‡æ¡£çš„ç±»åˆ«ï¼ˆè´¢ç»ï¼Œä½“è‚²ï¼Œå†›äº‹......ï¼‰

é‚£ä¹ˆï¼Œä¸€ç¯‡æ–‡æ¡£ä¸ºè´¢ç»å’Œå†›äº‹çš„æ¦‚ç‡è®¡ç®—å¦‚ä¸‹ï¼š
- `P(è´¢ç»|è¯1, è¯2, è¯3) = P(è¯1, è¯2, è¯3|è´¢ç») * P(è´¢ç»)/P(W)`
- `P(å†›äº‹|è¯1, è¯2, è¯3) = P(è¯1, è¯2, è¯3|å†›äº‹) * P(å†›äº‹)/P(W)`

ä¸Šè¿°ä¸¤ä¸ªå…¬å¼ä¸­éƒ½æœ‰æƒ³ç”¨çš„ `P(W)`ï¼Œå¯ä»¥æŠµæ¶ˆï¼Œåˆ™å…¬å¼ç®€åŒ–ä¸ºï¼š
  - `P(è¯1, è¯2, è¯3|è´¢ç»)*P(è´¢ç») ==> P(W|C)*P(C)`
  - `P(è¯1, è¯2, è¯3|å†›äº‹)*P(å†›äº‹) ==> P(W|C)*P(C)`

è¿™æ ·çš„å…¬å¼æˆ‘ä»¬æ˜¯å¯ä»¥è¿›è¡Œè®¡ç®—çš„ï¼Œè¿™å°±æ˜¯æ¡ä»¶æ¦‚ç‡
- `P(C)`ï¼šæ¯ä¸ªæ–‡æ¡£ç±»åˆ«çš„æ¦‚ç‡ï¼ˆæŸä¸ªæ–‡æ¡£ç±»åˆ«æ–‡ç« çš„æ•°é‡/æ€»æ–‡æ¡£æ•°é‡ï¼‰
- `P(W|C)`ï¼šç»™å®šç±»åˆ«ä¸‹ç‰¹å¾çš„æ¦‚ç‡ï¼Œæ­¤å¤„çš„ç‰¹å¾å°±æ˜¯é¢„æµ‹æ–‡æ¡£ä¸­å‡ºç°çš„è¯è¯­
- `P(W|C)` çš„è®¡ç®—æ–¹æ³•ï¼š`P(F1|C) = Ni/N`
  - F1ï¼šé¢„æµ‹æ–‡æ¡£ä¸­çš„æŸä¸€ä¸ªè¯ï¼ŒC ä¸ºæŒ‡å®šçš„ç±»åˆ«
  - Niï¼šF1 è¿™ä¸ªè¯åœ¨ C ç±»åˆ«æ‰€æœ‰æ–‡æ¡£ä¸­å‡ºç°çš„æ¬¡æ•°
  - Nï¼šæ‰€å±ç±»åˆ« Cä¸‹ çš„æ–‡æ¡£æ‰€æœ‰è¯å‡ºç°çš„æ¬¡æ•°å’Œ

å®ä¾‹æ¨å¯¼ï¼Œè¯·çœ‹é¢˜ï¼š

![shilituidao](naive-bayes.assets/shilituidao.png)

è§£é‡Šï¼šä¸Šå›¾çš„è¡¨æ ¼ä¸ºè®­ç»ƒé›†çš„ç»Ÿè®¡ç»“æœï¼Œè®­ç»ƒé›†ä¸­ä¸€å…±æœ‰ 30 ç¯‡ç§‘æŠ€æ–‡ç« ï¼Œ60 ç¯‡å¨±ä¹æ–‡ç« ï¼Œå…±è®¡ 90 ç¯‡æ–‡ç« ã€‚è¿™äº›æ–‡ç« ä¸­æ ¹æ® tf-idf æå–å‡ºé‡è¦çš„è¯è¯­åˆ†åˆ«æœ‰ï¼ˆå•†åœºï¼Œå½±é™¢ï¼Œæ”¯ä»˜å®å’Œäº‘è®¡ç®—ï¼‰ï¼Œç„¶åè¿™äº›è¯åˆ†åˆ«åœ¨ä¸åŒè®­ç»ƒé›†ä¸­ä¸åŒç±»åˆ«æ–‡ç« ä¸­å‡ºç°çš„æ¬¡æ•°ä¹Ÿç»Ÿè®¡å‡ºæ¥äº†ã€‚

ç°åœ¨æœ‰ä¸€ä¸ªå°†è¦è¢«é¢„æµ‹çš„æ–‡ç« ï¼Œè¯¥æ–‡ç« ä¸­å‡ºç°é‡è¦çš„æ¬¡ä¸ºå½±é™¢ï¼Œæ”¯ä»˜å®å’Œäº‘è®¡ç®—ï¼Œåˆ™è®¡ç®—è¯¥æ–‡ç« å±äºç§‘æŠ€ã€å¨±ä¹çš„æ¦‚ç‡åˆ†åˆ«æ˜¯å¤šå°‘ï¼Ÿ

![image.png](naive-bayes.assets/Tue,%2021%20Apr%202020%20005240.png)

æ€è€ƒï¼šå±äºæŸä¸ªç±»åˆ«çš„æ¦‚ç‡ä¸º 0ï¼Œåˆé€‚å—ï¼Ÿ

ä¼¼ä¹ä¸å¤ªåˆé€‚ã€‚è™½ç„¶è¢«é¢„æµ‹æ–‡ç« ä¸­æ²¡æœ‰å‡ºç°äº‘è®¡ç®—è¿™ä¸ªè¯è¯­ï¼Œä½†æ˜¯å‡ºç°å¨±ä¹ç±»åˆ«ä¸­çš„å…¶ä»–è¯ï¼Œæ‰€ä»¥æ¦‚ç‡ä¸º 0 ä¸åˆé€‚ï¼é‚£ä¹ˆå¦‚ä½•å¤„ç†å‘¢ï¼Ÿ

![image.png](naive-bayes.assets/Tue,%2021%20Apr%202020%20005238.png)

æœ´ç´ è´å¶æ–¯ API
- `from sklearn.naive_bayes import MultinomialNB`
- `MultinomialNB(alpha=1.0, fit_prior=True, class_prior=None)`
  - alphaï¼šæ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ç³»æ•°

å®æˆ˜ï¼šæ•°æ®ä½¿ç”¨- å®æˆ˜ï¼šæ•°æ®ä½¿ç”¨ fetch_20newsgroups ä¸­çš„æ•°æ®ï¼ŒåŒ…å«äº† 20 ä¸ªä¸»é¢˜çš„ 18000 ä¸ªæ–°é—»ç»„çš„å¸–å­

æµç¨‹ï¼š
- åŠ è½½ 20 ç±»æ–°é—»æ•°æ®ï¼Œå¹¶è¿›è¡Œæ ·æœ¬åˆ†å‰²
- ç”Ÿæˆæ–‡ç« ç‰¹å¾è¯
- ä½¿ç”¨æ¨¡å‹è¿›è¡Œæ–‡ç« åˆ†ç±»

sklearn æ–‡æœ¬ç‰¹å¾æå–â€”â€”TfidfVectorizerï¼ˆæ±‚å‡º Ni/N çš„å€¼ï¼‰

ä»€ä¹ˆæ˜¯ TF-IDFï¼š
- Ni/Nï¼šå¯ä»¥è¡¨ç¤ºä¸€ä¸ªè¯å¯¹äºæ•´ç‰‡æ–‡ç« çš„é‡è¦æ€§ã€‚
- TFï¼šè¯é¢‘ã€‚`TF(w)=(è¯wåœ¨æ–‡æ¡£ä¸­å‡ºç°çš„æ¬¡æ•°)/(æ–‡æ¡£çš„æ€»è¯æ•°) == P(F1|C)=Ni/N`
- IDFï¼šé€†å‘æ–‡ç« é¢‘ç‡ã€‚æœ‰äº›è¯å¯èƒ½åœ¨æ–‡æœ¬ä¸­é¢‘ç¹å‡ºç°ï¼Œä½†å¹¶ä¸é‡è¦ï¼Œä¹Ÿå³ä¿¡æ¯é‡å°ï¼Œå¦‚ isã€ofã€that è¿™äº›å•è¯ã€‚è¿™äº›å•è¯åœ¨è¯­æ–™åº“ä¸­å‡ºç°çš„é¢‘ç‡ä¹Ÿéå¸¸å¤§ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ç‚¹ï¼Œé™ä½å…¶æƒé‡ã€‚`IDF(w)=log_e(è¯­æ–™åº“çš„æ€»æ–‡æ¡£æ•°)/(è¯­æ–™åº“ä¸­è¯wã€Šis, of...ã€‹å‡ºç°çš„æ–‡æ¡£æ•°)`ã€‚e æ˜¯è‡ªç„¶å¯¹æ•°çš„åº•æ•°ï¼Œæ˜¯ä¸€ä¸ªæ— é™ä¸å¾ªç¯å°æ•°ï¼Œå…¶å€¼æ˜¯2.71828...
- TF-IDFï¼šå°†ä¸Šé¢çš„ TF-IDF ç›¸ä¹˜å°±å¾—åˆ°äº†ç»¼åˆå‚æ•°ï¼š`TF-IDF = TF * IDF`

#### ç¤ºä¾‹ï¼šæ–°é—»åˆ†ç±»

ä¸‹é¢ï¼Œæˆ‘ä»¬ç”¨æ–°é—»å†…å®¹åˆ†ç±»çš„ç¤ºä¾‹æ¼”ç¤ºä¸€ä¸‹ã€‚

é¦–å…ˆï¼Œè·å–æ•°æ®ï¼Œå°†å…¶æ‹†åˆ†æˆæµ‹è¯•é›†å’Œè®­ç»ƒé›†ï¼š

```python
from sklearn import datasets
from sklearn.model_selection import train_test_split
news = datasets.fetch_20newsgroups(subset='all')
feature = news.data    # è¿”å›çš„æ˜¯åˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­ä¸ºä¸€ç¯‡ç¯‡çš„æ–‡ç« 
target = news.target    # è¿”å›çš„ndarray,å­˜å‚¨çš„æ˜¯æ¯ä¸€ç¯‡æ–‡ç« çš„ç±»åˆ«
x_train, x_test, y_train, y_test = train_test_split(feature, target, random_state=20, test_size=0.25)
```

ä½¿ç”¨ TF-IDF å¯¹æ•°æ®é›†è¿›è¡Œç‰¹å¾æŠ½å–ï¼š

```python
from sklearn.feature_extraction.text import TfidfVectorizer
tf = TfidfVectorizer()
x_train = tf.fit_transform(x_train)    # è¿”å›è®­ç»ƒé›†æ‰€æœ‰æ–‡ç« ä¸­æ¯ä¸ªè¯çš„é‡è¦æ€§
x_test = tf.transform(x_test)    # è¿”å›æµ‹è¯•é›†æ‰€æœ‰æ–‡ç« ä¸­æ¯ä¸ªè¯çš„é‡è¦æ€§
# print(tf.get_feature_names())    # æ‰€æœ‰æ–‡ç« ä¸­å‡ºç°çš„è¯è¯­
```

è®­ç»ƒæ¨¡å‹ï¼Œæµ‹è¯•æ¨¡å‹ï¼š

```python
from sklearn.naive_bayes import MultinomialNB
mnb = MultinomialNB(alpha=1)
mnb.fit(x_train, y_train)
y_pred = mnb.predict(x_test)
print('é¢„æµ‹æ–‡ç« ç±»åˆ«ä¸ºï¼š', y_pred)
print('çœŸå®æ–‡ç« ç±»åˆ«ä¸ºï¼š', y_test)
print('å‡†ç¡®ç‡ä¸ºï¼š', mnb.score(x_test, y_test))
```

è¾“å‡ºçš„ç»“æœä¸ºï¼š

```python
é¢„æµ‹æ–‡ç« ç±»åˆ«ä¸ºï¼š [18 16 11 ...  9  2 16]
çœŸå®æ–‡ç« ç±»åˆ«ä¸ºï¼š [18 16 11 ...  9  2  6]
å‡†ç¡®ç‡ä¸ºï¼š 0.8550509337860781
```

æ³¨æ„ï¼š

- fit_transform å¹²äº†ä¸¤ä»¶äº‹ï¼šfit æ‰¾åˆ°æ•°æ®è½¬æ¢è§„åˆ™ï¼Œå¹¶å°†æ•°æ®æ ‡å‡†åŒ–
- transformï¼šæ˜¯å°†æ•°æ®è¿›è¡Œè½¬æ¢ï¼Œæ¯”å¦‚æ•°æ®çš„å½’ä¸€åŒ–å’Œæ ‡å‡†åŒ–ï¼Œå°†æµ‹è¯•æ•°æ®æŒ‰ç…§è®­ç»ƒæ•°æ®åŒæ ·çš„æ¨¡å‹è¿›è¡Œè½¬æ¢ï¼Œå¾—åˆ°ç‰¹å¾å‘é‡ã€‚å¯ä»¥ç›´æ¥æŠŠè½¬æ¢è§„åˆ™æ‹¿æ¥ç”¨ï¼Œæ‰€ä»¥å¹¶ä¸éœ€è¦ fit_transformï¼Œå¦åˆ™ï¼Œä¸¤æ¬¡æ ‡å‡†åŒ–åçš„æ•°æ®æ ¼å¼ï¼ˆæˆ–è€…è¯´æ•°æ®å‚æ•°ï¼‰å°±ä¸ä¸€æ ·äº†ã€‚

#### ç¤ºä¾‹ï¼šæ‰‹å†™æ•°å­—è¯†åˆ«

å†æ¥å°è¯•å¯¹ sklearn æä¾›çš„æ‰‹å†™æ•°å­—æ•°æ®è¿›è¡Œè¯†åˆ«ã€‚

```python
from sklearn.datasets import load_digits
from sklearn.model_selection import train_test_split
from sklearn.naive_bayes import MultinomialNB

digits = load_digits()
feature = digits.data
target = digits.target

x_train, x_test, y_train, y_test = train_test_split(feature, target, random_state=420, test_size=0.2)

mnb = MultinomialNB(alpha=1)
mnb.fit(x_train, y_train)

mnb.score(x_test, y_test)    # 0.9138888888888889
```

åŸç†å¾ˆéš¾ï¼Œä½†æ˜¯ä»£ç å†™èµ·æ¥å´ä¸€æ°”å‘µæˆã€‚è¯†åˆ«çš„å‡†ç¡®ç‡ä¹Ÿæ˜¯è›®é«˜çš„ã€‚

### ä¼¯åŠªåˆ©æ¨¡å‹

å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯å¯åŒæ—¶å¤„ç†äºŒé¡¹åˆ†å¸ƒï¼ˆæŠ›ç¡¬å¸ï¼‰å’Œå¤šé¡¹åˆ†å¸ƒï¼ˆæ·éª°å­ï¼‰ï¼Œå…¶ä¸­äºŒé¡¹åˆ†å¸ƒåˆå«åšä¼¯åŠªåˆ©åˆ†å¸ƒï¼Œå®ƒæ˜¯ä¸€ç§ç°å®ä¸­å¸¸è§ï¼Œå¹¶ä¸”æ‹¥æœ‰å¾ˆå¤šä¼˜è¶Šæ•°å­¦æ€§è´¨çš„åˆ†å¸ƒã€‚å› æ­¤ï¼Œæ—¢ç„¶æœ‰ç€å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯ï¼Œæˆ‘ä»¬è‡ªç„¶ä¹Ÿå°±åˆä¸“é—¨ç”¨æ¥å¤„ç†äºŒé¡¹åˆ†å¸ƒçš„æœ´ç´ è´å¶æ–¯ï¼šä¼¯åŠªåˆ©æœ´ç´ è´å¶æ–¯ã€‚

ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æ•°æ®é›†ä¸­å¯ä»¥å­˜åœ¨å¤šä¸ªç‰¹å¾ï¼Œä½†æ¯ä¸ªç‰¹å¾éƒ½æ˜¯äºŒåˆ†ç±»çš„ï¼Œå¯ä»¥ä»¥å¸ƒå°”å˜é‡è¡¨ç¤ºï¼Œä¹Ÿå¯ä»¥è¡¨ç¤ºä¸º `{0ï¼Œ1}` æˆ–è€… `{-1ï¼Œ1}` ç­‰ä»»æ„äºŒåˆ†ç±»ç»„åˆã€‚å› æ­¤ï¼Œè¿™ä¸ªç±»è¦æ±‚å°†æ ·æœ¬è½¬æ¢ä¸ºäºŒåˆ†ç±»ç‰¹å¾å‘é‡ï¼Œå¦‚æœæ•°æ®æœ¬èº«ä¸æ˜¯äºŒåˆ†ç±»çš„ï¼Œé‚£å¯ä»¥ä½¿ç”¨ç±»ä¸­ä¸“é—¨ç”¨æ¥äºŒå€¼åŒ–çš„å‚æ•° binarize æ¥æ”¹å˜æ•°æ®ã€‚

ä¼¯åŠªåˆ©æœ´ç´ è´å¶æ–¯ä¸å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯éå¸¸ç›¸ä¼¼ï¼Œéƒ½å¸¸ç”¨äºå¤„ç†æ–‡æœ¬åˆ†ç±»æ•°æ®ã€‚ä½†ç”±äºä¼¯åŠªåˆ©æœ´ç´ è´å¶æ–¯æ˜¯å¤„ç†äºŒé¡¹åˆ†å¸ƒï¼Œæ‰€ä»¥å®ƒæ›´åŠ åœ¨æ„çš„æ˜¯â€œæ˜¯ä¸å¦â€ã€‚åˆ¤å®šä¸€ç¯‡æ–‡ç« æ˜¯å¦å±äºä½“è‚²èµ„è®¯ï¼Œè€Œä¸æ˜¯è¯´å±äºä½“è‚²ç±»è¿˜æ˜¯å¨±ä¹ç±»ã€‚

ä¼¯åŠªåˆ©æ¨¡å‹ APIï¼š

- `class sklearn.naive_bayes.BernoulliNB (alpha=1.0, binarize=0.0, fit_prior=True, class_prior=None)`

å‚æ•°ä»‹ç»ï¼š

  - alphaï¼šæ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ç³»æ•°
  - binarizeï¼šå¯ä»¥æ˜¯æ•°å€¼æˆ–è€…ä¸è¾“å…¥ã€‚å¦‚æœä¸è¾“å…¥ï¼Œåˆ™ BernoulliNB è®¤ä¸ºæ¯ä¸ªæ•°æ®ç‰¹å¾éƒ½å·²ç»æ˜¯äºŒå…ƒï¼ˆäºŒå€¼åŒ–ï¼‰çš„ã€‚å¦åˆ™çš„è¯ï¼Œå°äº binarize çš„ä¼šå½’ä¸ºä¸€ç±»ï¼Œå¤§äº binarize çš„ä¼šå½’ä¸ºå¦å¤–ä¸€ç±»

ç”±äºä¼¯åŠªåˆ©åˆ†å¸ƒåªèƒ½å¤„ç†äºŒåˆ†ç±»çš„æ•°æ®ï¼Œæ‰€ä»¥åœ¨è®­ç»ƒæ¨¡å‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæ•°æ®è½¬æ¢æˆä¸¤ä¸ªåˆ†ç±»çš„å½¢å¼ï¼Œä¹Ÿå°±æ˜¯è¿›è¡ŒäºŒå€¼åŒ–æ“ä½œã€‚äºŒå€¼åŒ–æ“ä½œç¤ºä¾‹ï¼š

```python
import numpy as np
from sklearn.preprocessing import Binarizer
x = np.array([[1, -2, 2, 3, 1, 10],
             [1, 2, 3, 33, 4, -90],
             [11, 29, 90, -80, 0, 4]])
binarizer = Binarizer(threshold=5)    # thresholdé˜ˆå€¼ï¼Œé»˜è®¤0.0
binarizer.fit_transform(x)
```

è®¾å®šé˜ˆå€¼ä¸º 5 çš„äºŒå€¼åŒ–ç»“æœä¸ºï¼š

```python
array([[0, 0, 0, 0, 0, 1],
       [0, 0, 0, 1, 0, 0],
       [1, 1, 1, 0, 0, 0]])
```

æˆ‘ä»¬ä½¿ç”¨ä¼¯åŠªåˆ©æ¨¡å‹æ¥å¯¹æ‰‹å†™æ•°å­—è¿›è¡Œè¯†åˆ«ï¼š

```python
from sklearn.datasets import load_digits
from sklearn.model_selection import train_test_split
from sklearn.naive_bayes import BernoulliNB

digits = load_digits()
feature = digits.data
target = digits.target

x_train, x_test, y_train, y_test = train_test_split(feature, target, random_state=420, test_size=0.2)

bnb = BernoulliNB()    # é»˜è®¤è¿›è¡ŒäºŒå€¼åŒ–å¤„ç†ï¼Œbinarize=0.0
bnb.fit(x_train, y_train)

bnb.score(x_test, y_test)    # 0.8722222222222222
```

è¿˜å¯ä»¥å¯¹æ–°é—»åˆ†ç±»è¿›è¡Œç±»ä¼¼çš„é¢„æµ‹ï¼š

```python 
from sklearn.datasets import fetch_20newsgroups
from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.naive_bayes import BernoulliNB

news = fetch_20newsgroups(subset='all')
feature = news.data
target = news.target

x_train, x_test, y_train, y_test = train_test_split(feature, target, random_state=20, test_size=0.25)

tf = TfidfVectorizer()
x_train = tf.fit_transform(x_train)
x_test = tf.transform(x_test)

bnb = BernoulliNB()
bnb.fit(x_train, y_train)

y_pred = bnb.predict(x_train)
print('é¢„æµ‹æ–‡ç« ç±»åˆ«ä¸ºï¼š', y_pred)
print('çœŸå®æ–‡ç« ç±»åˆ«ä¸ºï¼š', y_test)
print('å‡†ç¡®ç‡ä¸ºï¼š', bnb.score(x_test, y_test))
```

è¾“å‡ºçš„ç»“æœä¸ºï¼š

```python
é¢„æµ‹æ–‡ç« ç±»åˆ«ä¸ºï¼š [17  6  6 ...  6  4  0]
çœŸå®æ–‡ç« ç±»åˆ«ä¸ºï¼š [18 16 11 ...  9  2  6]
å‡†ç¡®ç‡ä¸ºï¼š 0.6973684210526315
```

å¯è§ï¼Œå¯¹äºéäºŒåˆ†ç±»çš„æ•°æ®æ¥è¯´ï¼Œä½¿ç”¨ä¼¯åŠªåˆ©æ¨¡å‹æ•ˆæœå¹¶ä¸å¾ˆå¥½ã€‚

### æœ´ç´ è´å¶æ–¯åˆ†ç±»ä¼˜ç¼ºç‚¹

ä¼˜ç‚¹ï¼š

- æœ´ç´ è´å¶æ–¯æ¨¡å‹å‘æºäºå¤å…¸æ•°å­¦ç†è®ºï¼Œæœ‰ç¨³å®šçš„åˆ†ç±»æ•ˆç‡
- å¯¹ç¼ºå¤±æ•°æ®ä¸å¤ªæ•æ„Ÿï¼Œç®—æ³•ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå¸¸ç”¨äºæ–‡æœ¬åˆ†ç±»
- åˆ†ç±»å‡†ç¡®åº¦é«˜ï¼Œé€Ÿåº¦å¿«

ç¼ºç‚¹ï¼š

- ç”±äºä½¿ç”¨äº†æ ·æœ¬å±æ€§ç‹¬ç«‹çš„å‡è®¾ï¼Œæ‰€ä»¥å¦‚æœæ ·æœ¬å±æ€§æœ‰å…³è”çš„æ—¶å€™ï¼Œåˆ†ç±»æ•ˆæœä¸å¥½